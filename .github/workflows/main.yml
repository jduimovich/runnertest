name: run-crc-self-hosted-actions
env:    
  DEPLOY: "deploy-openshift"
on:
  # Learn more about events https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows
  push:
    # Edit to the branch(es) you want to build and deploy on each push.
    branches: [ main ]
jobs:
  test-shell:
    name: Use CRC and Sample App Testing
    runs-on: self-hosted 
    steps:
    - uses: actions/checkout@v2 
    - name: Install oc
      uses: redhat-actions/oc-installer@v1
      with:
        version: '4.6'
    - name: Install CRC 
      run: | 
        echo "Installing CRC on local machine enabled scripts "
        echo "TBD: Do this manually  "
    - name: Start CRC
      run: | 
        echo "Starting CRC"
        sh scripts/crc-start
    - name: Login CRC 
      run: | 
        echo "Login CRC "
        crc-login
    - name: Test OC
      run: |  
        oc get nodes
    - name: Test OC
      run: |  
        oc apply -f deploy-openshift
    - name: Stop CRC
      run: |  
        crc stop
 
 
 
  
